{%- extends "base.html" %}

{% block titleex -%} 查詢結果 ({{ result.pokemon.name_zh }}) {%- endblock %}

{% block layout %}<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='layouts/recipe_result.css') }}">{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-xs-2 set-center">
            <img class="icon-fluid" src="/static/Icon/{{ result.pokemon.id }}.png" />
        </div>
        <div class="col-xs-10 set-center">
            <a class="pokemon-title" href="{{ url_for('.pokemon_profile_result', id=result.pokemon.id) }}">#{{ result.pokemon.id }} {{ result.pokemon.name_zh }}</a>
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th class="set-center">食譜</th>
                            <th class="set-center">品質</th>
                            <th class="set-center">機率</th>
                            <th class="set-center">官方機率</th>
                            <th class="set-center">樣本</th>
                        </tr>
                    </thead>
                    {% for entry in result.data %}
                    {% set o_prob = off_prob.get_data(entry.recipe.id, entry.recipe_quality|int) %}
                    <tr>
                        <td><a href="{{ url_for('.find_pokemon_result', id=entry.recipe.id) }}"><img class="icon" src="/static/Recipe/{{ entry.recipe.id }}.png" />&nbsp;{{ entry.recipe.title_zh }}</a></td>
                        <td>{{ entry.recipe_quality|string() }}</td>
                        <td>{{ "(無資料)" if o_prob is none else "{:.2%}".format(o_prob) }}</td>
                        <td>{{ "{:.2%}".format(entry.probability) }}</td>
                        <td>{{ entry.get_sample_size_string() }}</td>
                    </tr>
                    <tr>
                        <td>配方</td>
                        <td colspan="4">
                            {% for comp in entry.recipe_dish.items %}
                            <div class="comp-block">
                                {% for item in comp %}
                                <img class="icon" src="/static/Item/{{ item }}.png" />
                                {% endfor %}
                            </div>
                            &nbsp;&nbsp;&nbsp;
                            {% endfor %}
                        </td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
    <div class="well well-sm foot-info">資料處理花費 {{ "{:.3f}".format(result.time_consumed) }}秒</div>
</div>
{%- endblock %}
